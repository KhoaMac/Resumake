var resume={basicInfo:{},contactInfo:{},educationInfo:[],skillInfo:[],experienceInfo:[],activityInfo:[]},educationEdit={isEdit:!1,index:-1,awards:[]},skillEdit={isEdit:!1,index:-1,skills:[]},experienceEdit={isEdit:!1,index:-1,items:[]},activityEdit={isEdit:!1,index:-1,items:[]};
function addAward(){var a=educationEdit.awards.length,b=$("#education-award-name").attr("value");$("#education-award-name").attr("value","");$("#education-award-list").html("");educationEdit.awards[a]=b;repopulateAwards()}
function repopulateAwards(){$("#education-award-list").html("");for(var a=0;a<educationEdit.awards.length;a++){var b=educationEdit.awards[a];$("#education-award-list").append('<li class="span3 education-award" id="award-'+a+'">'+b+'<button class="close pull-right" id="award-'+a+'">x</button></li>');$("button#award-"+a).click(function(){var a=$(this).attr("id").substring(6);$("li#award-"+a).remove();educationEdit.awards=[];$("li.education-award").each(function(){var a=$(this).text();educationEdit.awards.push(a.substring(0,
a.length-1))})})}}
function saveEducation(){if(educationEdit.isEdit){var a=""+$("#education-school").attr("value"),b=""+$("#education-degree").attr("value"),c=""+$("#education-startDate").attr("value"),d=""+$("#education-endDate").attr("value"),e=[];$(".education-award").each(function(){var a=$(this).text();e.push(a.substring(0,a.length-1))});$("#education-school").attr("value","");$("#education-degree").attr("value","");$("#education-startDate").attr("value","");$("#education-endDate").attr("value","");$("#education-award-list").html("");
resume.educationInfo[educationEdit.index]={school:a,degree:b,startDate:c,endDate:d,awards:e}}else a=""+$("#education-school").attr("value"),b=""+$("#education-degree").attr("value"),c=""+$("#education-startDate").attr("value"),d=""+$("#education-endDate").attr("value"),e=[],$(".education-award").each(function(){var a=$(this).text();e.push(a.substring(0,a.length-1))}),$("#education-school").attr("value",""),$("#education-degree").attr("value",""),$("#education-startDate").attr("value",""),$("#education-endDate").attr("value",
""),$("#education-award-list").html(""),resume.educationInfo.push({school:a,degree:b,startDate:c,endDate:d,awards:e});revalidateEducationField()}
function revalidateEducationField(){$("#education-container").html("");for(var a=0;a<resume.educationInfo.length;a++){for(var b=resume.educationInfo[a].awards,c='<div class="education-object" id = "edu-obj-'+a+'"><a class="close" id="education-delete-'+a+'">X</a><h3><a class="education-edit-link" id="education-edit-'+a+'" href="#education-modal" data-toggle="modal">'+resume.educationInfo[a].school+"</a></h3><p><strong>"+resume.educationInfo[a].degree+"</strong> "+getFullFormatDate(resume.educationInfo[a].startDate,
resume.educationInfo[a].endDate)+"</p>",d=0;d<b.length;d++)c+="<p><strong>"+b[d]+"</strong></p>";c+="</div>";$("#education-container").append(c);$("#education-edit-"+a).click(function(){var a=$(this).attr("id").substring(15);editEducation(a)});$("#education-delete-"+a).click(function(){var a=$(this).attr("id").substring(17);resume.educationInfo.splice(a,1);$("#edu-obj-"+a).remove()})}}
function editEducation(a){educationEdit.isEdit=!0;educationEdit.index=a;educationEdit.awards=resume.educationInfo[a].awards;var b=resume.educationInfo[a].school,c=resume.educationInfo[a].degree,d=resume.educationInfo[a].startDate,a=resume.educationInfo[a].endDate;$("#education-school").attr("value",b);$("#education-degree").attr("value",c);$("#education-startDate").attr("value",d);$("#education-endDate").attr("value",a);repopulateAwards()}
function addSkill(){var a=skillEdit.skills.length,b=$("#skill-name").attr("value"),c=$("#skill-desc").attr("value");$("#skill-name").attr("value","");$("#skill-desc").attr("value","");$("#skill-list").html("");skillEdit.skills[a]={name:b,desc:c};repopulateSkills()}
function repopulateSkills(){$("#skill-list").html("");for(var a=0;a<skillEdit.skills.length;a++){var b=skillEdit.skills[a];$("#skill-list").append('<li class="span3 skill-item" id="skill-'+a+'"><button class="close pull-right" id="skill-'+a+'">x</button><p><strong>'+b.name+"</strong></p><p>"+b.desc+"</p></li>");$("button#skill-"+a).click(function(){var a=$(this).attr("id").substring(6);$("li#skill-"+a).remove();skillEdit.skills=[];$("li.skill-item").each(function(){var a=$(this).html().split("</strong></p><p>"),
b=a[0].split("<strong>"),b=b[b.length-1],a=a[1].replace("</p></li>","");skillEdit.skills.push({name:b,desc:a})})})}}
function saveSkillCategory(){if(skillEdit.isEdit){var a=""+$("#skill-category").attr("value"),b=skillEdit.skills;$("#skill-category").attr("value","");$("#skill-list").html("");resume.skillInfo[skillEdit.index]={category:a,skills:b}}else a=""+$("#skill-category").attr("value"),b=skillEdit.skills,$("#skill-category").attr("value",""),$("#skill-list").html(""),resume.skillInfo.push({category:a,skills:b});revalidateSkillField()}
function revalidateSkillField(){$("#skill-container").html("");for(var a=0;a<resume.skillInfo.length;a++){for(var b=resume.skillInfo[a].skills,c='<div class="skill-object" id = "skill-object-'+a+'"><a class="close" id="skill-delete-'+a+'">X</a><h3><a class="skill-edit-link" id="skill-edit-'+a+'" href="#skill-modal" data-toggle="modal">'+resume.skillInfo[a].category+"</a></h3>",d=0;d<b.length;d++)c+="<p><strong>"+b[d].name+"</strong> - "+b[d].desc+"</p>";c+="</div>";$("#skill-container").append(c);
$("#skill-edit-"+a).click(function(){var a=$(this).attr("id").substring(11);editSkill(a)});$("#skill-delete-"+a).click(function(){var a=$(this).attr("id").substring(13);resume.skillInfo.splice(a,1);revalidateSkillField()})}}function editSkill(a){skillEdit.isEdit=!0;skillEdit.index=a;skillEdit.skills=resume.skillInfo[a].skills;a=resume.skillInfo[a].category;$("#skill-category").attr("value",a);repopulateSkills()}
function addLinkExperience(){var a=experienceEdit.items.length,b=$("#experience-link-name").attr("value"),c=$("#experience-link").attr("value");$("#experience-link-name").attr("value","");$("#experience-link").attr("value","");$("#experience-item-list").html("");experienceEdit.items[a]={type:"link",name:b,link:c};repopulateExperienceItems()}
function addDescExperience(){var a=experienceEdit.items.length,b=$("#experience-desc").attr("value");$("#experience-desc").attr("value","");$("#experience-item-list").html("");experienceEdit.items[a]={type:"desc",desc:b};repopulateExperienceItems()}
function repopulateExperienceItems(){$("#experience-item-list").html("");for(var a=0;a<experienceEdit.items.length;a++){var b=experienceEdit.items[a],b="desc"==b.type?"<p><strong>"+b.desc+"</strong></p>":'<a href="'+b.link+'" target="_blank">'+b.name+"</a>";$("#experience-item-list").append('<li class="span3 experience-item" id="experience-'+a+'"><button class="close pull-right" id="experience-'+a+'">x</button>'+b+"</li>");$("button#experience-"+a).click(function(){var a=$(this).attr("id").substring(11);
$("li#experience-"+a).remove();experienceEdit.items=[];$("li.experience-item").each(function(){var a=$(this).html(),b=a.replace(a.split("</button>")[0]+"</button>","");if(0==b.indexOf("<p><strong>"))a=b.substring(11,b.length-13),experienceEdit.items.push({type:"desc",desc:a});else if(0==b.indexOf('<a href="')){var c=b.indexOf('" target="_blank">'),a=b.substring(c+18,b.length-4),b=b.substring(9,c);experienceEdit.items.push({type:"link",name:a,link:b})}})})}}
function saveExperienceCategory(){if(experienceEdit.isEdit){var a=""+$("#experience-position").attr("value"),b=""+$("#experience-start-date").attr("value"),c=""+$("#experience-end-date").attr("value"),d=""+$("#experience-group").attr("value"),e=experienceEdit.items;$("#experience-position").attr("value","");$("#experience-start-date").attr("value","");$("#experience-end-date").attr("value","");$("#experience-group").attr("value","");$("#experience-item-list").html("");resume.experienceInfo[experienceEdit.index]=
{position:a,startDate:b,endDate:c,group:d,items:e}}else a=""+$("#experience-position").attr("value"),b=""+$("#experience-start-date").attr("value"),c=""+$("#experience-end-date").attr("value"),d=""+$("#experience-group").attr("value"),e=experienceEdit.items,$("#experience-position").attr("value",""),$("#experience-start-date").attr("value",""),$("#experience-end-date").attr("value",""),$("#experience-group").attr("value",""),$("#experience-item-list").html(""),resume.experienceInfo.push({position:a,
startDate:b,endDate:c,group:d,items:e});revalidateExperienceField()}
function revalidateExperienceField(){$("#experience-container").html("");for(var a=0;a<resume.experienceInfo.length;a++){for(var b=resume.experienceInfo[a].items,c='<div class="experience-object" id = "experience-object-'+a+'"><a class="close" id="experience-delete-'+a+'">X</a><h3><a class="experience-edit-link" id="experience-edit-'+a+'" href="#experience-modal" data-toggle="modal">'+resume.experienceInfo[a].position+"</a></h3><h3>"+resume.experienceInfo[a].group+" "+getFullFormatDate(resume.experienceInfo[a].startDate,
resume.experienceInfo[a].endDate)+"</h3>",d=0;d<b.length;d++)"link"==b[d].type?c+='<a href="'+b[d].link+'" target="_blank">'+b[d].name+"</a>":"desc"==b[d].type&&(c+="<p><strong>"+b[d].desc+"</strong></p>");c+="</div>";$("#experience-container").append(c);$("#experience-edit-"+a).click(function(){var a=$(this).attr("id").substring(16);editExperience(a)});$("#experience-delete-"+a).click(function(){var a=$(this).attr("id").substring(18);resume.experienceInfo.splice(a,1);revalidateExperienceField()})}}
function editExperience(a){experienceEdit.isEdit=!0;experienceEdit.index=a;experienceEdit.items=resume.experienceInfo[a].items;var b=resume.experienceInfo[a].position,c=resume.experienceInfo[a].startDate,d=resume.experienceInfo[a].endDate,a=resume.experienceInfo[a].group;$("#experience-position").attr("value",b);$("#experience-start-date").attr("value",c);$("#experience-end-date").attr("value",d);$("#experience-group").attr("value",a);repopulateExperienceItems()}
function addLinkActivity(){var a=activityEdit.items.length,b=$("#activity-link-name").attr("value"),c=$("#activity-link").attr("value");$("#activity-link-name").attr("value","");$("#activity-link").attr("value","");$("#activity-item-list").html("");activityEdit.items[a]={type:"link",name:b,link:c};repopulateActivityItems()}
function addDescActivity(){var a=activityEdit.items.length,b=$("#activity-desc").attr("value");$("#activity-desc").attr("value","");$("#activity-item-list").html("");activityEdit.items[a]={type:"desc",desc:b};repopulateActivityItems()}
function repopulateActivityItems(){$("#activity-item-list").html("");for(var a=0;a<activityEdit.items.length;a++){var b=activityEdit.items[a],b="desc"==b.type?"<p><strong>"+b.desc+"</strong></p>":'<a href="'+b.link+'" target="_blank">'+b.name+"</a>";$("#activity-item-list").append('<li class="span3 activity-item" id="activity-'+a+'"><button class="close pull-right" id="activity-'+a+'">x</button>'+b+"</li>");$("button#activity-"+a).click(function(){var a=$(this).attr("id").substring(11);$("li#activity-"+
a).remove();activityEdit.items=[];$("li.activity-item").each(function(){var a=$(this).html(),b=a.replace(a.split("</button>")[0]+"</button>","");if(0==b.indexOf("<p><strong>"))a=b.substring(11,b.length-13),activityEdit.items.push({type:"desc",desc:a});else if(0==b.indexOf('<a href="')){var c=b.indexOf('" target="_blank">'),a=b.substring(c+18,b.length-4),b=b.substring(9,c);activityEdit.items.push({type:"link",name:a,link:b})}})})}}
function saveActivityCategory(){if(activityEdit.isEdit){var a=""+$("#activity-position").attr("value"),b=""+$("#activity-start-date").attr("value"),c=""+$("#activity-end-date").attr("value"),d=""+$("#activity-group").attr("value"),e=activityEdit.items;$("#activity-position").attr("value","");$("#activity-start-date").attr("value","");$("#activity-end-date").attr("value","");$("#activity-group").attr("value","");$("#activity-item-list").html("");resume.activityInfo[activityEdit.index]={position:a,
startDate:b,endDate:c,group:d,items:e}}else a=""+$("#activity-position").attr("value"),b=""+$("#activity-start-date").attr("value"),c=""+$("#activity-end-date").attr("value"),d=""+$("#activity-group").attr("value"),e=activityEdit.items,$("#activity-position").attr("value",""),$("#activity-start-date").attr("value",""),$("#activity-end-date").attr("value",""),$("#activity-group").attr("value",""),$("#activity-item-list").html(""),resume.activityInfo.push({position:a,startDate:b,endDate:c,group:d,items:e});
revalidateActivityField()}
function revalidateActivityField(){$("#activity-container").html("");for(var a=0;a<resume.activityInfo.length;a++){for(var b=resume.activityInfo[a].items,c='<div class="activity-object" id = "activity-object-'+a+'"><a class="close" id="activity-delete-'+a+'">X</a><h3><a class="activity-edit-link" id="activity-edit-'+a+'" href="#activity-modal" data-toggle="modal">'+resume.activityInfo[a].position+"</a></h3><h3>"+resume.activityInfo[a].group+" "+getFullFormatDate(resume.activityInfo[a].startDate,resume.activityInfo[a].endDate)+
"</h3>",d=0;d<b.length;d++)"link"==b[d].type?c+='<a href="'+b[d].link+'" target="_blank">'+b[d].name+"</a>":"desc"==b[d].type&&(c+="<p><strong>"+b[d].desc+"</strong></p>");c+="</div>";$("#activity-container").append(c);$("#activity-edit-"+a).click(function(){var a=$(this).attr("id").substring(16);editActivity(a)});$("#activity-delete-"+a).click(function(){var a=$(this).attr("id").substring(18);resume.activityInfo.splice(a,1);revalidateActivityField()})}}
function editActivity(a){activityEdit.isEdit=!0;activityEdit.index=a;activityEdit.items=resume.activityInfo[a].items;var b=resume.activityInfo[a].position,c=resume.activityInfo[a].startDate,d=resume.activityInfo[a].endDate,a=resume.activityInfo[a].group;$("#activity-position").attr("value",b);$("#activity-start-date").attr("value",c);$("#activity-end-date").attr("value",d);$("#activity-group").attr("value",a);repopulateActivityItems()}
function getFormattedDate(a){if(void 0==a||-1==a.indexOf("-"))return"";var b=a.split("-")[0],a=a.split("-")[1];"0"==a.charAt(0)&&(a=a.substring(1));return"January February March April May June July August September October November December".split(" ")[parseInt(a)-1]+" "+b}function getFullFormatDate(a,b){return""==getFormattedDate(b)?""!=getFormattedDate(a)?getFormattedDate(a)+" - Ongoing":"":""==getFormattedDate(a)?" Until "+getFormattedDate(b):getFormattedDate(a)+" - "+getFormattedDate(b)}
$(document).ready(function(){$("#education-award-add").click(function(){addAward()});$("#education-save").click(function(){saveEducation()});$("#add-education-btn").click(function(){educationEdit.isEdit&&($("#skill-category").attr("value",""),$("#skill-list").html(""));educationEdit.isEdit=!1;educationEdit.awards=[]});$("#skill-add").click(function(){addSkill()});$("#skill-save").click(function(){saveSkillCategory()});$("#add-skill-btn").click(function(){skillEdit.isEdit=!1;skillEdit.skills=[]});
$("#experience-fact-add").click(function(){addDescExperience()});$("#experience-link-add").click(function(){addLinkExperience()});$("#experience-save").click(function(){saveExperienceCategory()});$("#btn-add-experience").click(function(){experienceEdit.isEdit=!1;experienceEdit.items=[]});$("#activity-fact-add").click(function(){addDescActivity()});$("#activity-link-add").click(function(){addLinkActivity()});$("#activity-save").click(function(){saveActivityCategory()});$("#btn-add-activity").click(function(){activityEdit.isEdit=
!1;activityEdit.items=[]});$("#code-preview").click(function(){completeResume()});$("#code-submit").click(function(){completeResume();var a=$("#basic-resume").attr("value");$.post("../private/php_scripts/addResume.php",{uid:uid,resume:resume,name:a},function(a){window.location.href="../rmks/"+username+"/"+a})})});
function completeResume(){resume.basicInfo={name:$("#basic-name").attr("value"),position:$("#basic-position").attr("value"),statement:$("#basic-statement").attr("value")};resume.contactInfo={address:$("#contact-address").attr("value"),city:$("#contact-city").attr("value"),state:$("#contact-state").attr("value"),zip:$("#contact-zip").attr("value"),phoneNumber:$("#contact-phone").attr("value"),email:$("#contact-email").attr("value")}};